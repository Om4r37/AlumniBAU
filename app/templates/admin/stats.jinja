{% extends "layout.jinja" %}
{% set tab_number = 0 %}
{% set title = "Stats"%}
{% block main %}
<link rel="stylesheet" href="static/styles/dashboard.css">
<script src="/static/scripts/chart.min.js"></script>
<h1>Stats</h1>
<div class="container">
    {% set counters = ["alumni", "news", "posts", "comments", "likes", "dislikes"] %}
    {% for counter in counters %}
    <a href="/{{counter}}">
        <h3 id="{{counter}}">{{counter|capitalize}} Count: {{stats[counter + "_count"]}}</h3>
    </a>
    {% endfor %}
    <div class="counters">
        {% for counter in counters %}
        <h3 id="{{counter}}">{{counter|capitalize}} Count: {{stats[counter + "_count"]}}</h3>
        {% endfor %}
    </div>
    <canvas id="graduation_year"></canvas>
    <canvas id="gender"></canvas>
    <canvas id="rating"></canvas>
</div>
<script>
    {# var alumni = document.getElementById("alumni");
    alumni.style.cursor = "pointer";
    alumni.onclick = function() {
        window.location.href = "/alumni";
    };
    var news = document.getElementById("news");
    news.style.cursor = "pointer";
    news.onclick = function() {
        window.location.href = "/news";
    };
    var posts = document.getElementById("posts");
    posts.style.cursor = "pointer";
    posts.onclick = function() {
        window.location.href = "/posts";
    }; #}
    {% set years = ["2019", "2020", "2021", "2022", "2023"] %}
    var yearChart = new Chart(document.getElementById("graduation_year"), {
        type: 'bar',
        data: {
            labels: {{years}},
            datasets: [{
                data: [
                    {% for year in years %}
                        {{stats["_" + year + "_count"]}},
                    {% endfor %}
                ],
        backgroundColor: ["#FF6384", "#36A2EB", "#FFCE56", "#4bc0c0", "#ff9f40"],
    }]
        },
    options: {
        responsive: true,
        cutout: "80%",
        plugins: {
            title: {
                display: true,
                text: 'Graduation Year',
                font: {
                    size: 18
                }
            },
            legend: {
                display: false
            }
        }
    }
    });
    var genderChart = new Chart(document.getElementById("gender"), {
        type: 'doughnut',
        data: {
            labels: ["Male", "Female"],
            datasets: [{
                data: [{{ stats.male_count }}, {{ stats.female_count }}],
                backgroundColor: ["#36A2EB", "#FF6384"],
            }]
        },
        options: {
            responsive: true,
            cutout: "80%",
            plugins: {
                title: {
                    display: true,
                    text: 'Gender Distribution',
                    font: {
                        size: 18
                    }
                }
            }
        }
    });
    {% set ratings = ["excellent", "very_good", "good", "fair", "poor"] %}
    var smokeChart = new Chart(document.getElementById("rating"), {
        type: 'pie',
        data: {
            labels: {{ratings}},
            datasets: [{
                data: [
                    {% for rating in ratings %}
                        {{stats[rating + "_count"]}},
                    {% endfor %}
                ],
                backgroundColor: ["#FF6384", "#36A2EB", "#FFCE56", "#4bc0c0", "#ff9f40"],
            }]
        },
    options: {
        responsive: true,
            plugins: {
            title: {
                display: true,
                text: 'Rating Distribution',
                font: {
                    size: 18
                }
            },
            legend: {
                labels: {
                    font: {
                        size: 14
                    }
                }
            }
        }
    }
    });
</script>
{% endblock %}